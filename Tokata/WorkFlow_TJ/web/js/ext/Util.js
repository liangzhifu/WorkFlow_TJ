Ext.MessageBox.buttonText={ok:'<%=getI18NResource("bandCommon.sure")%>',cancel:'<%=getI18NResource("bandCommon.cancel")%>',yes:'<%=getI18NResource("bandCommon.yes")%>',no:'<%=getI18NResource("bandCommon.no")%>'};function IsInt(a){return((a%1)==0);}function makeDOM(){var d,a=[".4.0",".3.0",".2.0",""];for(var c=0;c<a.length;c++){try{if(window.ActiveXObject){d=new ActiveXObject("msxml2.DOMDocument"+a[c]);}else{if(document.implementation&&document.implementation.createDocument){d=document.implementation.createDocument("","",null);}}break;}catch(b){}}d.async=false;d.validateOnParse=false;d.resolveExternals=false;return d;}function getObjectType(a){if(a==null){return"n";}switch(a.constructor){case Number:if(IsInt(a)){return"i";}else{return"f";}case Boolean:return"b";case String:return"s";case Date:return"d";case Array:return"a";default:if(a.constructor.toString().indexOf("Array")>0){return"a";}else{if(a.constructor.toString().indexOf("Date")>0){return"d";}else{return"o";}}}}function packageObject(h,f,a){switch(f){case"n":break;case"b":case"i":case"l":case"f":case"s":h.text=StrEnCode(a.toString());break;case"d":h.text=DateToString(new Date(a.valueOf()),true);break;case"o":for(var e in a){var g=a[e];var c=getObjectType(g);var b=h.ownerDocument.createElement(c+e);h.appendChild(b);packageObject(b,c,g);}break;case"a":for(var d=0;d<a.length;d++){var g=a[d];var c=getObjectType(g);var b=h.ownerDocument.createElement(c+"Item");h.appendChild(b);packageObject(b,c,g);}break;}}function StrEnCode(a){return a;}function toXml(){if(arguments.length==0){return"";}var d=makeDOM();var c=d.createProcessingInstruction("xml","version='1.0'");d.appendChild(c);c=d.appendChild(d.createElement("Function"));c.setAttribute("name",arguments[1]);c.setAttribute("serviceName",arguments[0]);if(arguments[2]){c.setAttribute("userTransaction","true");}else{c.setAttribute("userTransaction","false");}c.setAttribute("generatedTime",new Date());for(var a=3;a<arguments.length;a++){var e=d.createElement("Param");var b=getObjectType(arguments[a]);e.setAttribute("type",b);packageObject(e,b,arguments[a]);c.appendChild(e);}return d.xml;}function packageError(a){var b=new Error(0,a.message);b.code=a.code;b.resolve=a.resolve;b.detail=a.detail;return b;}function callRemoteFunction(){var a=[];var d="dialogHeight:4;dialogWidth:25;status:no;center:yes;scroll:no;";var f=null;if(arguments.length==0){return false;}for(var c=0;c<arguments.length;c++){a.push(arguments[c]);}var b=toXml.apply(this,a);var j=Ext.Ajax.request({url:"/IOMPROJ/iomextservlet",success:function(){},failure:function(){},params:{xml:b},listeners:{requestexception:function(){}}});if(j.conn.responseText=="null"){f=window.showModalDialog("/IOMPROJ/ext/public/Error.jsp",null,d);}if(j.conn.responseText.indexOf("[")!=-1&&j.conn.responseText.lastIndexOf("[")!=1){try{f=Ext.decode(j.conn.responseText);if(f.length>0){if(f[0].hasOwnProperty("Error")){f=window.showModalDialog("/IOMPROJ/ext/public/Error.jsp",f,d);if(f!=null&&f!=undefined&&f!="undefined"&&f!="null"&&f!=""){var g=new Ext.Window({layout:"fit",title:'    <%=getI18NResource("common.systemDetailsError")%>',width:700,height:500,closeAction:"hide",plain:true,modal:true,html:'<div contentEditable="true" style = "width:680px; height:465px; overflow:auto;">'+f+"</div>"});g.show();}}}}catch(h){f=j.conn.responseText;}}else{f=j.conn.responseText;}j=null;return f;}function callRemoteFunctionJson(){var a=[];var d="dialogHeight:4;dialogWidth:25;status:no;center:yes;scroll:no;";var f=null;if(arguments.length==0){return false;}for(var c=0;c<arguments.length;c++){a.push(arguments[c]);}var b=toXml.apply(this,a);var j=Ext.Ajax.request({url:"/IOMPROJ/iomextservlet",success:function(){},failure:function(){},params:{xml:b},listeners:{requestexception:function(){}}});if(j.conn.responseText=="null"){f=window.showModalDialog("/IOMPROJ/ext/public/Error.jsp",null,d);}try{f=Ext.decode(j.conn.responseText);if(f.length>0){if(f[0]&&f[0].hasOwnProperty&&f[0].hasOwnProperty("Error")){f=window.showModalDialog("/IOMPROJ/ext/public/Error.jsp",f,d);if(f!=null&&f!=undefined&&f!="undefined"&&f!="null"&&f!=""){var g=new Ext.Window({layout:"fit",title:'    <%=getI18NResource("common.systemDetailsError")%>',width:700,height:500,closeAction:"hide",plain:true,modal:true,html:'<div contentEditable="true" style = "width:680px; height:465px; overflow:auto;">'+f+"</div>"});g.show();}}}}catch(h){f=j.conn.responseText;}j=null;return f;}function callRemoteFunctionAysn(){var a=[];if(arguments.length==0){return false;}for(var c=1;c<arguments.length;c++){a.push(arguments[c]);}var b=toXml.apply(this,a);b=encodeURI(encodeURI(b));var d;if(window.ActiveXObject){ajax=new ActiveXObject("MSXML2.XmlHttp");}else{ajax=new XMLHttpRequest();}try{ajax.onreadystatechange=arguments[0];d="xml="+b;ajax.open("POST","/IOMPROJ/iomextservlet",true);ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded");ajax.send(d);}catch(f){alert(f.message);}}function callRemoteFunctionAysnCom(){var a=[];var d;if(arguments.length==0){return false;}for(var c=1;c<arguments.length;c++){a.push(arguments[c]);}var b=toXml.apply(this,a);b=encodeURI(encodeURI(b));var f;if(window.ActiveXObject){d=new ActiveXObject("MSXML2.XmlHttp");}else{d=new XMLHttpRequest();}try{d.onreadystatechange=arguments[0];f="xml="+b;d.open("POST","/IOMPROJ/iomextservlet",true);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(f);return d;}catch(g){alert(g.message);}}